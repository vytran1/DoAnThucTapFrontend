<div class="modal-wrapper">
  <mat-card class="product-modal-card mat-elevation-z4">
    <mat-card-title>Select Product Variant</mat-card-title>

    <mat-card-content>
      <div class="filter-row sticky-filter">
        <!-- Filter by name -->
        <mat-form-field appearance="fill">
          <mat-label>Search by Name</mat-label>
          <input matInput [(ngModel)]="nameFilter" />
        </mat-form-field>

        <!-- Filter by category -->
        <mat-form-field appearance="fill">
          <mat-label>Select Category</mat-label>
          <mat-select (selectionChange)="onCategoryChange($event.value)">
            <mat-option [value]="null">All</mat-option>
            <mat-option *ngFor="let cat of categories" [value]="cat.id">
              {{ cat.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <button mat-flat-button color="primary" (click)="onFilter()">
          Filter
        </button>
      </div>

      <!-- Table -->
      <table mat-table [dataSource]="dataSource" class="full-width">
        <ng-container matColumnDef="sku">
          <th mat-header-cell *matHeaderCellDef>SKU</th>
          <td mat-cell *matCellDef="let element">{{ element.sku }}</td>
        </ng-container>

        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Name</th>
          <td mat-cell *matCellDef="let element">{{ element.name }}</td>
        </ng-container>

        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef>Quantity</th>
          <td mat-cell *matCellDef="let element">
            {{ element.current_quantity }}
          </td>
        </ng-container>

        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef>Price</th>
          <td mat-cell *matCellDef="let element">
            {{ element.cost_price | currency : "USD" : "symbol" : "1.0-0" }}
          </td>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef>Action</th>
          <td mat-cell *matCellDef="let element">
            <button
              mat-button
              color="primary"
              (click)="onAddToCart(element)"
              [disabled]="element.current_quantity === 0"
            >
              Add to Cart
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </mat-card-content>

    <mat-card-actions class="action-row">
      <button mat-button (click)="onCancel()">Close</button>
      <app-page-num
        [currentPage]="pageNum"
        [pageSize]="pageSize"
        [totalItems]="totalItems"
        (pageChange)="onPageChange($event)"
      ></app-page-num>
    </mat-card-actions>
  </mat-card>
</div>
