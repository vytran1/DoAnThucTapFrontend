<div class="product-search-container">
  <!-- Search bar -->
  <div class="search-bar">
    <mat-form-field appearance="outline" class="search-input">
      <mat-label>Type Inventory Name</mat-label>
      <input
        matInput
        [formControl]="searchControl"
        [matAutocomplete]="auto"
        placeholder="e.g. INV001"
      />
      <mat-autocomplete
        #auto="matAutocomplete"
        (optionSelected)="onSelect($event)"
      >
        <mat-option *ngFor="let inv of filteredInventories" [value]="inv.id">
          {{ inv.inventory_code }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </div>

  <!-- Result Table -->
  <div *ngIf="stockResults.length > 0" class="result-table">
    <table mat-table [dataSource]="stockResults" class="mat-elevation-z2">
      <!-- Image Column -->
      <ng-container matColumnDef="image">
        <th mat-header-cell *matHeaderCellDef>Image</th>
        <td mat-cell *matCellDef="let element">
          @if(element.image == ' ' || element.image == 'product_default.png'){
          <img
            [src]="prefix + '/' + element.image"
            alt="product image"
            width="60"
          />
          }@else{
          <img
            [src]="prefix + '/' + element.id + '/' + element.image"
            alt="product image"
            width="60"
          />
          }
        </td>
      </ng-container>

      <!-- SKU Column -->
      <ng-container matColumnDef="sku">
        <th mat-header-cell *matHeaderCellDef>SKU Code</th>
        <td mat-cell *matCellDef="let element">
          {{ element.name }}
        </td>
      </ng-container>

      <!-- Quantity Column -->
      <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef>Quantity</th>
        <td mat-cell *matCellDef="let element">
          {{ element.quantity }}
        </td>
      </ng-container>

      <!-- Header and Row -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        [ngClass]="{ 'danger-row': row.quantity === 0 }"
      ></tr>
    </table>
  </div>

  <!-- Modal -->
  @if (isOpenMessageModal) {
  <app-message-modal
    [message]="message"
    [title]="title"
    (closed)="closeModal()"
  ></app-message-modal>
  }
</div>
