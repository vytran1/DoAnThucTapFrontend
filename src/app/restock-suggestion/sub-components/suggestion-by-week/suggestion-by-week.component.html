<div class="filter-container">
  <mat-form-field appearance="fill" class="date-field">
    <mat-label>Start Date</mat-label>
    <input matInput [value]="startDate | date : 'yyyy-MM-dd'" disabled />
  </mat-form-field>

  <mat-form-field appearance="fill" class="date-field">
    <mat-label>End Date</mat-label>
    <input matInput [value]="endDate | date : 'yyyy-MM-dd'" disabled />
  </mat-form-field>

  <mat-form-field appearance="fill" class="filter-select">
    <mat-label>Filter</mat-label>
    <mat-select [(value)]="filterMode" (selectionChange)="applyFilter()">
      <mat-option value="all">All</mat-option>
      <mat-option value="need">Need Import</mat-option>
      <mat-option value="noNeed">No Need</mat-option>
    </mat-select>
  </mat-form-field>

  <button
    mat-raised-button
    color="primary"
    class="import-btn"
    (click)="redirectToCreateOrder()"
  >
    <mat-icon>add_shopping_cart</mat-icon> Importing More
  </button>
</div>

<!-- Table -->
<table
  mat-table
  [dataSource]="filteredSuggestions"
  class="mat-elevation-z2 suggestion-table"
>
  <!-- SKU -->
  <ng-container matColumnDef="sku">
    <th mat-header-cell *matHeaderCellDef>SKU</th>
    <td mat-cell *matCellDef="let element">{{ element.sku }}</td>
  </ng-container>

  <!-- Name -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef>Product Name</th>
    <td mat-cell *matCellDef="let element">{{ element.name }}</td>
  </ng-container>

  <!-- Current Stock -->
  <ng-container matColumnDef="total_current_stocking">
    <th mat-header-cell *matHeaderCellDef>Current Stock</th>
    <td mat-cell *matCellDef="let element">
      {{ element.total_current_stocking }}
    </td>
  </ng-container>

  <!-- Sold -->
  <ng-container matColumnDef="total_saled_quantity">
    <th mat-header-cell *matHeaderCellDef>Sold</th>
    <td mat-cell *matCellDef="let element">
      {{ element.total_saled_quantity }}
    </td>
  </ng-container>

  <!-- Avg/Day -->
  <ng-container matColumnDef="average_saled_quantity">
    <th mat-header-cell *matHeaderCellDef>Avg/Day</th>
    <td mat-cell *matCellDef="let element">
      {{ element.average_saled_quantity | number : "1.0-1" }}
    </td>
  </ng-container>

  <!-- Predict -->
  <ng-container matColumnDef="predict_quantity_for_next_period">
    <th mat-header-cell *matHeaderCellDef>Predicted Next Period</th>
    <td mat-cell *matCellDef="let element">
      {{ element.predict_quantity_for_next_period }}
    </td>
  </ng-container>

  <ng-container matColumnDef="suggestion_quantity">
    <th mat-header-cell *matHeaderCellDef>Suggestion Quantity</th>
    <td mat-cell *matCellDef="let element">
      {{
        getSuggestionQuantity(element) > 0
          ? getSuggestionQuantity(element)
          : "Sufficient"
      }}
    </td>
  </ng-container>

  <!-- Need Import -->
  <ng-container matColumnDef="need_to_be_imported">
    <th mat-header-cell *matHeaderCellDef>Need Import?</th>
    <td mat-cell *matCellDef="let element">
      <mat-icon *ngIf="element.need_to_be_imported" color="warn"
        >priority_high</mat-icon
      >
      <mat-icon *ngIf="!element.need_to_be_imported" color="primary"
        >check_circle</mat-icon
      >
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="columns"></tr>
  <tr
    mat-row
    *matRowDef="let row; columns: columns"
    [ngClass]="{
      'need-import': row.need_to_be_imported,
      'no-import': !row.need_to_be_imported
    }"
  ></tr>
</table>
